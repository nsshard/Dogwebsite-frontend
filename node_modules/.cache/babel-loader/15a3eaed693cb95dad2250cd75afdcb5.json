{"ast":null,"code":"'use strict';\n/**\n * Module dependencies.\n */\n\nconst contentDisposition = require('content-disposition');\n\nconst getType = require('cache-content-type');\n\nconst onFinish = require('on-finished');\n\nconst escape = require('escape-html');\n\nconst typeis = require('type-is').is;\n\nconst statuses = require('statuses');\n\nconst destroy = require('destroy');\n\nconst assert = require('assert');\n\nconst extname = require('path').extname;\n\nconst vary = require('vary');\n\nconst only = require('only');\n\nconst util = require('util');\n\nconst encodeUrl = require('encodeurl');\n\nconst Stream = require('stream');\n/**\n * Prototype.\n */\n\n\nmodule.exports = {\n  /**\n   * Return the request socket.\n   *\n   * @return {Connection}\n   * @api public\n   */\n  get socket() {\n    return this.res.socket;\n  },\n\n  /**\n   * Return response header.\n   *\n   * @return {Object}\n   * @api public\n   */\n  get header() {\n    const {\n      res\n    } = this;\n    return typeof res.getHeaders === 'function' ? res.getHeaders() : res._headers || {}; // Node < 7.7\n  },\n\n  /**\n   * Return response header, alias as response.header\n   *\n   * @return {Object}\n   * @api public\n   */\n  get headers() {\n    return this.header;\n  },\n\n  /**\n   * Get response status code.\n   *\n   * @return {Number}\n   * @api public\n   */\n  get status() {\n    return this.res.statusCode;\n  },\n\n  /**\n   * Set response status code.\n   *\n   * @param {Number} code\n   * @api public\n   */\n  set status(code) {\n    if (this.headerSent) return;\n    assert(Number.isInteger(code), 'status code must be a number');\n    assert(code >= 100 && code <= 999, `invalid status code: ${code}`);\n    this._explicitStatus = true;\n    this.res.statusCode = code;\n    if (this.req.httpVersionMajor < 2) this.res.statusMessage = statuses[code];\n    if (this.body && statuses.empty[code]) this.body = null;\n  },\n\n  /**\n   * Get response status message\n   *\n   * @return {String}\n   * @api public\n   */\n  get message() {\n    return this.res.statusMessage || statuses[this.status];\n  },\n\n  /**\n   * Set response status message\n   *\n   * @param {String} msg\n   * @api public\n   */\n  set message(msg) {\n    this.res.statusMessage = msg;\n  },\n\n  /**\n   * Get response body.\n   *\n   * @return {Mixed}\n   * @api public\n   */\n  get body() {\n    return this._body;\n  },\n\n  /**\n   * Set response body.\n   *\n   * @param {String|Buffer|Object|Stream} val\n   * @api public\n   */\n  set body(val) {\n    const original = this._body;\n    this._body = val; // no content\n\n    if (null == val) {\n      if (!statuses.empty[this.status]) this.status = 204;\n      if (val === null) this._explicitNullBody = true;\n      this.remove('Content-Type');\n      this.remove('Content-Length');\n      this.remove('Transfer-Encoding');\n      return;\n    } // set the status\n\n\n    if (!this._explicitStatus) this.status = 200; // set the content-type only if not yet set\n\n    const setType = !this.has('Content-Type'); // string\n\n    if ('string' === typeof val) {\n      if (setType) this.type = /^\\s*</.test(val) ? 'html' : 'text';\n      this.length = Buffer.byteLength(val);\n      return;\n    } // buffer\n\n\n    if (Buffer.isBuffer(val)) {\n      if (setType) this.type = 'bin';\n      this.length = val.length;\n      return;\n    } // stream\n\n\n    if (val instanceof Stream) {\n      onFinish(this.res, destroy.bind(null, val));\n\n      if (original != val) {\n        val.once('error', err => this.ctx.onerror(err)); // overwriting\n\n        if (null != original) this.remove('Content-Length');\n      }\n\n      if (setType) this.type = 'bin';\n      return;\n    } // json\n\n\n    this.remove('Content-Length');\n    this.type = 'json';\n  },\n\n  /**\n   * Set Content-Length field to `n`.\n   *\n   * @param {Number} n\n   * @api public\n   */\n  set length(n) {\n    if (!this.has('Transfer-Encoding')) {\n      this.set('Content-Length', n);\n    }\n  },\n\n  /**\n   * Return parsed response Content-Length when present.\n   *\n   * @return {Number}\n   * @api public\n   */\n  get length() {\n    if (this.has('Content-Length')) {\n      return parseInt(this.get('Content-Length'), 10) || 0;\n    }\n\n    const {\n      body\n    } = this;\n    if (!body || body instanceof Stream) return undefined;\n    if ('string' === typeof body) return Buffer.byteLength(body);\n    if (Buffer.isBuffer(body)) return body.length;\n    return Buffer.byteLength(JSON.stringify(body));\n  },\n\n  /**\n   * Check if a header has been written to the socket.\n   *\n   * @return {Boolean}\n   * @api public\n   */\n  get headerSent() {\n    return this.res.headersSent;\n  },\n\n  /**\n   * Vary on `field`.\n   *\n   * @param {String} field\n   * @api public\n   */\n  vary(field) {\n    if (this.headerSent) return;\n    vary(this.res, field);\n  },\n\n  /**\n   * Perform a 302 redirect to `url`.\n   *\n   * The string \"back\" is special-cased\n   * to provide Referrer support, when Referrer\n   * is not present `alt` or \"/\" is used.\n   *\n   * Examples:\n   *\n   *    this.redirect('back');\n   *    this.redirect('back', '/index.html');\n   *    this.redirect('/login');\n   *    this.redirect('http://google.com');\n   *\n   * @param {String} url\n   * @param {String} [alt]\n   * @api public\n   */\n  redirect(url, alt) {\n    // location\n    if ('back' === url) url = this.ctx.get('Referrer') || alt || '/';\n    this.set('Location', encodeUrl(url)); // status\n\n    if (!statuses.redirect[this.status]) this.status = 302; // html\n\n    if (this.ctx.accepts('html')) {\n      url = escape(url);\n      this.type = 'text/html; charset=utf-8';\n      this.body = `Redirecting to <a href=\"${url}\">${url}</a>.`;\n      return;\n    } // text\n\n\n    this.type = 'text/plain; charset=utf-8';\n    this.body = `Redirecting to ${url}.`;\n  },\n\n  /**\n   * Set Content-Disposition header to \"attachment\" with optional `filename`.\n   *\n   * @param {String} filename\n   * @api public\n   */\n  attachment(filename, options) {\n    if (filename) this.type = extname(filename);\n    this.set('Content-Disposition', contentDisposition(filename, options));\n  },\n\n  /**\n   * Set Content-Type response header with `type` through `mime.lookup()`\n   * when it does not contain a charset.\n   *\n   * Examples:\n   *\n   *     this.type = '.html';\n   *     this.type = 'html';\n   *     this.type = 'json';\n   *     this.type = 'application/json';\n   *     this.type = 'png';\n   *\n   * @param {String} type\n   * @api public\n   */\n  set type(type) {\n    type = getType(type);\n\n    if (type) {\n      this.set('Content-Type', type);\n    } else {\n      this.remove('Content-Type');\n    }\n  },\n\n  /**\n   * Set the Last-Modified date using a string or a Date.\n   *\n   *     this.response.lastModified = new Date();\n   *     this.response.lastModified = '2013-09-13';\n   *\n   * @param {String|Date} type\n   * @api public\n   */\n  set lastModified(val) {\n    if ('string' === typeof val) val = new Date(val);\n    this.set('Last-Modified', val.toUTCString());\n  },\n\n  /**\n   * Get the Last-Modified date in Date form, if it exists.\n   *\n   * @return {Date}\n   * @api public\n   */\n  get lastModified() {\n    const date = this.get('last-modified');\n    if (date) return new Date(date);\n  },\n\n  /**\n   * Set the ETag of a response.\n   * This will normalize the quotes if necessary.\n   *\n   *     this.response.etag = 'md5hashsum';\n   *     this.response.etag = '\"md5hashsum\"';\n   *     this.response.etag = 'W/\"123456789\"';\n   *\n   * @param {String} etag\n   * @api public\n   */\n  set etag(val) {\n    if (!/^(W\\/)?\"/.test(val)) val = `\"${val}\"`;\n    this.set('ETag', val);\n  },\n\n  /**\n   * Get the ETag of a response.\n   *\n   * @return {String}\n   * @api public\n   */\n  get etag() {\n    return this.get('ETag');\n  },\n\n  /**\n   * Return the response mime type void of\n   * parameters such as \"charset\".\n   *\n   * @return {String}\n   * @api public\n   */\n  get type() {\n    const type = this.get('Content-Type');\n    if (!type) return '';\n    return type.split(';', 1)[0];\n  },\n\n  /**\n   * Check whether the response is one of the listed types.\n   * Pretty much the same as `this.request.is()`.\n   *\n   * @param {String|String[]} [type]\n   * @param {String[]} [types]\n   * @return {String|false}\n   * @api public\n   */\n  is(type) {\n    for (var _len = arguments.length, types = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      types[_key - 1] = arguments[_key];\n    }\n\n    return typeis(this.type, type, ...types);\n  },\n\n  /**\n   * Return response header.\n   *\n   * Examples:\n   *\n   *     this.get('Content-Type');\n   *     // => \"text/plain\"\n   *\n   *     this.get('content-type');\n   *     // => \"text/plain\"\n   *\n   * @param {String} field\n   * @return {String}\n   * @api public\n   */\n  get(field) {\n    return this.header[field.toLowerCase()] || '';\n  },\n\n  /**\n   * Returns true if the header identified by name is currently set in the outgoing headers.\n   * The header name matching is case-insensitive.\n   *\n   * Examples:\n   *\n   *     this.has('Content-Type');\n   *     // => true\n   *\n   *     this.get('content-type');\n   *     // => true\n   *\n   * @param {String} field\n   * @return {boolean}\n   * @api public\n   */\n  has(field) {\n    return typeof this.res.hasHeader === 'function' ? this.res.hasHeader(field) // Node < 7.7\n    : field.toLowerCase() in this.headers;\n  },\n\n  /**\n   * Set header `field` to `val` or pass\n   * an object of header fields.\n   *\n   * Examples:\n   *\n   *    this.set('Foo', ['bar', 'baz']);\n   *    this.set('Accept', 'application/json');\n   *    this.set({ Accept: 'text/plain', 'X-API-Key': 'tobi' });\n   *\n   * @param {String|Object|Array} field\n   * @param {String} val\n   * @api public\n   */\n  set(field, val) {\n    if (this.headerSent) return;\n\n    if (2 === arguments.length) {\n      if (Array.isArray(val)) val = val.map(v => typeof v === 'string' ? v : String(v));else if (typeof val !== 'string') val = String(val);\n      this.res.setHeader(field, val);\n    } else {\n      for (const key in field) {\n        this.set(key, field[key]);\n      }\n    }\n  },\n\n  /**\n   * Append additional header `field` with value `val`.\n   *\n   * Examples:\n   *\n   * ```\n   * this.append('Link', ['<http://localhost/>', '<http://localhost:3000/>']);\n   * this.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly');\n   * this.append('Warning', '199 Miscellaneous warning');\n   * ```\n   *\n   * @param {String} field\n   * @param {String|Array} val\n   * @api public\n   */\n  append(field, val) {\n    const prev = this.get(field);\n\n    if (prev) {\n      val = Array.isArray(prev) ? prev.concat(val) : [prev].concat(val);\n    }\n\n    return this.set(field, val);\n  },\n\n  /**\n   * Remove header `field`.\n   *\n   * @param {String} name\n   * @api public\n   */\n  remove(field) {\n    if (this.headerSent) return;\n    this.res.removeHeader(field);\n  },\n\n  /**\n   * Checks if the request is writable.\n   * Tests for the existence of the socket\n   * as node sometimes does not set it.\n   *\n   * @return {Boolean}\n   * @api private\n   */\n  get writable() {\n    // can't write any more after response finished\n    // response.writableEnded is available since Node > 12.9\n    // https://nodejs.org/api/http.html#http_response_writableended\n    // response.finished is undocumented feature of previous Node versions\n    // https://stackoverflow.com/questions/16254385/undocumented-response-finished-in-node-js\n    if (this.res.writableEnded || this.res.finished) return false;\n    const socket = this.res.socket; // There are already pending outgoing res, but still writable\n    // https://github.com/nodejs/node/blob/v4.4.7/lib/_http_server.js#L486\n\n    if (!socket) return true;\n    return socket.writable;\n  },\n\n  /**\n   * Inspect implementation.\n   *\n   * @return {Object}\n   * @api public\n   */\n  inspect() {\n    if (!this.res) return;\n    const o = this.toJSON();\n    o.body = this.body;\n    return o;\n  },\n\n  /**\n   * Return JSON representation.\n   *\n   * @return {Object}\n   * @api public\n   */\n  toJSON() {\n    return only(this, ['status', 'message', 'header']);\n  },\n\n  /**\n   * Flush any set headers and begin the body\n   */\n  flushHeaders() {\n    this.res.flushHeaders();\n  }\n\n};\n/**\n * Custom inspection implementation for node 6+.\n *\n * @return {Object}\n * @api public\n */\n\n/* istanbul ignore else */\n\nif (util.inspect.custom) {\n  module.exports[util.inspect.custom] = module.exports.inspect;\n}","map":{"version":3,"names":["contentDisposition","require","getType","onFinish","escape","typeis","is","statuses","destroy","assert","extname","vary","only","util","encodeUrl","Stream","module","exports","socket","res","header","getHeaders","_headers","headers","status","statusCode","code","headerSent","Number","isInteger","_explicitStatus","req","httpVersionMajor","statusMessage","body","empty","message","msg","_body","val","original","_explicitNullBody","remove","setType","has","type","test","length","Buffer","byteLength","isBuffer","bind","once","err","ctx","onerror","n","set","parseInt","get","undefined","JSON","stringify","headersSent","field","redirect","url","alt","accepts","attachment","filename","options","lastModified","Date","toUTCString","date","etag","split","types","toLowerCase","hasHeader","arguments","Array","isArray","map","v","String","setHeader","key","append","prev","concat","removeHeader","writable","writableEnded","finished","inspect","o","toJSON","flushHeaders","custom"],"sources":["C:/Users/Administrator/Desktop/webAPI work/web/dog-website/node_modules/koa/lib/response.js"],"sourcesContent":["\n'use strict';\n\n/**\n * Module dependencies.\n */\n\nconst contentDisposition = require('content-disposition');\nconst getType = require('cache-content-type');\nconst onFinish = require('on-finished');\nconst escape = require('escape-html');\nconst typeis = require('type-is').is;\nconst statuses = require('statuses');\nconst destroy = require('destroy');\nconst assert = require('assert');\nconst extname = require('path').extname;\nconst vary = require('vary');\nconst only = require('only');\nconst util = require('util');\nconst encodeUrl = require('encodeurl');\nconst Stream = require('stream');\n\n/**\n * Prototype.\n */\n\nmodule.exports = {\n\n  /**\n   * Return the request socket.\n   *\n   * @return {Connection}\n   * @api public\n   */\n\n  get socket() {\n    return this.res.socket;\n  },\n\n  /**\n   * Return response header.\n   *\n   * @return {Object}\n   * @api public\n   */\n\n  get header() {\n    const { res } = this;\n    return typeof res.getHeaders === 'function'\n      ? res.getHeaders()\n      : res._headers || {}; // Node < 7.7\n  },\n\n  /**\n   * Return response header, alias as response.header\n   *\n   * @return {Object}\n   * @api public\n   */\n\n  get headers() {\n    return this.header;\n  },\n\n  /**\n   * Get response status code.\n   *\n   * @return {Number}\n   * @api public\n   */\n\n  get status() {\n    return this.res.statusCode;\n  },\n\n  /**\n   * Set response status code.\n   *\n   * @param {Number} code\n   * @api public\n   */\n\n  set status(code) {\n    if (this.headerSent) return;\n\n    assert(Number.isInteger(code), 'status code must be a number');\n    assert(code >= 100 && code <= 999, `invalid status code: ${code}`);\n    this._explicitStatus = true;\n    this.res.statusCode = code;\n    if (this.req.httpVersionMajor < 2) this.res.statusMessage = statuses[code];\n    if (this.body && statuses.empty[code]) this.body = null;\n  },\n\n  /**\n   * Get response status message\n   *\n   * @return {String}\n   * @api public\n   */\n\n  get message() {\n    return this.res.statusMessage || statuses[this.status];\n  },\n\n  /**\n   * Set response status message\n   *\n   * @param {String} msg\n   * @api public\n   */\n\n  set message(msg) {\n    this.res.statusMessage = msg;\n  },\n\n  /**\n   * Get response body.\n   *\n   * @return {Mixed}\n   * @api public\n   */\n\n  get body() {\n    return this._body;\n  },\n\n  /**\n   * Set response body.\n   *\n   * @param {String|Buffer|Object|Stream} val\n   * @api public\n   */\n\n  set body(val) {\n    const original = this._body;\n    this._body = val;\n\n    // no content\n    if (null == val) {\n      if (!statuses.empty[this.status]) this.status = 204;\n      if (val === null) this._explicitNullBody = true;\n      this.remove('Content-Type');\n      this.remove('Content-Length');\n      this.remove('Transfer-Encoding');\n      return;\n    }\n\n    // set the status\n    if (!this._explicitStatus) this.status = 200;\n\n    // set the content-type only if not yet set\n    const setType = !this.has('Content-Type');\n\n    // string\n    if ('string' === typeof val) {\n      if (setType) this.type = /^\\s*</.test(val) ? 'html' : 'text';\n      this.length = Buffer.byteLength(val);\n      return;\n    }\n\n    // buffer\n    if (Buffer.isBuffer(val)) {\n      if (setType) this.type = 'bin';\n      this.length = val.length;\n      return;\n    }\n\n    // stream\n    if (val instanceof Stream) {\n      onFinish(this.res, destroy.bind(null, val));\n      if (original != val) {\n        val.once('error', err => this.ctx.onerror(err));\n        // overwriting\n        if (null != original) this.remove('Content-Length');\n      }\n\n      if (setType) this.type = 'bin';\n      return;\n    }\n\n    // json\n    this.remove('Content-Length');\n    this.type = 'json';\n  },\n\n  /**\n   * Set Content-Length field to `n`.\n   *\n   * @param {Number} n\n   * @api public\n   */\n\n  set length(n) {\n    if (!this.has('Transfer-Encoding')) {\n      this.set('Content-Length', n);\n    }\n  },\n\n  /**\n   * Return parsed response Content-Length when present.\n   *\n   * @return {Number}\n   * @api public\n   */\n\n  get length() {\n    if (this.has('Content-Length')) {\n      return parseInt(this.get('Content-Length'), 10) || 0;\n    }\n\n    const { body } = this;\n    if (!body || body instanceof Stream) return undefined;\n    if ('string' === typeof body) return Buffer.byteLength(body);\n    if (Buffer.isBuffer(body)) return body.length;\n    return Buffer.byteLength(JSON.stringify(body));\n  },\n\n  /**\n   * Check if a header has been written to the socket.\n   *\n   * @return {Boolean}\n   * @api public\n   */\n\n  get headerSent() {\n    return this.res.headersSent;\n  },\n\n  /**\n   * Vary on `field`.\n   *\n   * @param {String} field\n   * @api public\n   */\n\n  vary(field) {\n    if (this.headerSent) return;\n\n    vary(this.res, field);\n  },\n\n  /**\n   * Perform a 302 redirect to `url`.\n   *\n   * The string \"back\" is special-cased\n   * to provide Referrer support, when Referrer\n   * is not present `alt` or \"/\" is used.\n   *\n   * Examples:\n   *\n   *    this.redirect('back');\n   *    this.redirect('back', '/index.html');\n   *    this.redirect('/login');\n   *    this.redirect('http://google.com');\n   *\n   * @param {String} url\n   * @param {String} [alt]\n   * @api public\n   */\n\n  redirect(url, alt) {\n    // location\n    if ('back' === url) url = this.ctx.get('Referrer') || alt || '/';\n    this.set('Location', encodeUrl(url));\n\n    // status\n    if (!statuses.redirect[this.status]) this.status = 302;\n\n    // html\n    if (this.ctx.accepts('html')) {\n      url = escape(url);\n      this.type = 'text/html; charset=utf-8';\n      this.body = `Redirecting to <a href=\"${url}\">${url}</a>.`;\n      return;\n    }\n\n    // text\n    this.type = 'text/plain; charset=utf-8';\n    this.body = `Redirecting to ${url}.`;\n  },\n\n  /**\n   * Set Content-Disposition header to \"attachment\" with optional `filename`.\n   *\n   * @param {String} filename\n   * @api public\n   */\n\n  attachment(filename, options) {\n    if (filename) this.type = extname(filename);\n    this.set('Content-Disposition', contentDisposition(filename, options));\n  },\n\n  /**\n   * Set Content-Type response header with `type` through `mime.lookup()`\n   * when it does not contain a charset.\n   *\n   * Examples:\n   *\n   *     this.type = '.html';\n   *     this.type = 'html';\n   *     this.type = 'json';\n   *     this.type = 'application/json';\n   *     this.type = 'png';\n   *\n   * @param {String} type\n   * @api public\n   */\n\n  set type(type) {\n    type = getType(type);\n    if (type) {\n      this.set('Content-Type', type);\n    } else {\n      this.remove('Content-Type');\n    }\n  },\n\n  /**\n   * Set the Last-Modified date using a string or a Date.\n   *\n   *     this.response.lastModified = new Date();\n   *     this.response.lastModified = '2013-09-13';\n   *\n   * @param {String|Date} type\n   * @api public\n   */\n\n  set lastModified(val) {\n    if ('string' === typeof val) val = new Date(val);\n    this.set('Last-Modified', val.toUTCString());\n  },\n\n  /**\n   * Get the Last-Modified date in Date form, if it exists.\n   *\n   * @return {Date}\n   * @api public\n   */\n\n  get lastModified() {\n    const date = this.get('last-modified');\n    if (date) return new Date(date);\n  },\n\n  /**\n   * Set the ETag of a response.\n   * This will normalize the quotes if necessary.\n   *\n   *     this.response.etag = 'md5hashsum';\n   *     this.response.etag = '\"md5hashsum\"';\n   *     this.response.etag = 'W/\"123456789\"';\n   *\n   * @param {String} etag\n   * @api public\n   */\n\n  set etag(val) {\n    if (!/^(W\\/)?\"/.test(val)) val = `\"${val}\"`;\n    this.set('ETag', val);\n  },\n\n  /**\n   * Get the ETag of a response.\n   *\n   * @return {String}\n   * @api public\n   */\n\n  get etag() {\n    return this.get('ETag');\n  },\n\n  /**\n   * Return the response mime type void of\n   * parameters such as \"charset\".\n   *\n   * @return {String}\n   * @api public\n   */\n\n  get type() {\n    const type = this.get('Content-Type');\n    if (!type) return '';\n    return type.split(';', 1)[0];\n  },\n\n  /**\n   * Check whether the response is one of the listed types.\n   * Pretty much the same as `this.request.is()`.\n   *\n   * @param {String|String[]} [type]\n   * @param {String[]} [types]\n   * @return {String|false}\n   * @api public\n   */\n\n  is(type, ...types) {\n    return typeis(this.type, type, ...types);\n  },\n\n  /**\n   * Return response header.\n   *\n   * Examples:\n   *\n   *     this.get('Content-Type');\n   *     // => \"text/plain\"\n   *\n   *     this.get('content-type');\n   *     // => \"text/plain\"\n   *\n   * @param {String} field\n   * @return {String}\n   * @api public\n   */\n\n  get(field) {\n    return this.header[field.toLowerCase()] || '';\n  },\n\n  /**\n   * Returns true if the header identified by name is currently set in the outgoing headers.\n   * The header name matching is case-insensitive.\n   *\n   * Examples:\n   *\n   *     this.has('Content-Type');\n   *     // => true\n   *\n   *     this.get('content-type');\n   *     // => true\n   *\n   * @param {String} field\n   * @return {boolean}\n   * @api public\n   */\n\n  has(field) {\n    return typeof this.res.hasHeader === 'function'\n      ? this.res.hasHeader(field)\n      // Node < 7.7\n      : field.toLowerCase() in this.headers;\n  },\n\n  /**\n   * Set header `field` to `val` or pass\n   * an object of header fields.\n   *\n   * Examples:\n   *\n   *    this.set('Foo', ['bar', 'baz']);\n   *    this.set('Accept', 'application/json');\n   *    this.set({ Accept: 'text/plain', 'X-API-Key': 'tobi' });\n   *\n   * @param {String|Object|Array} field\n   * @param {String} val\n   * @api public\n   */\n\n  set(field, val) {\n    if (this.headerSent) return;\n\n    if (2 === arguments.length) {\n      if (Array.isArray(val)) val = val.map(v => typeof v === 'string' ? v : String(v));\n      else if (typeof val !== 'string') val = String(val);\n      this.res.setHeader(field, val);\n    } else {\n      for (const key in field) {\n        this.set(key, field[key]);\n      }\n    }\n  },\n\n  /**\n   * Append additional header `field` with value `val`.\n   *\n   * Examples:\n   *\n   * ```\n   * this.append('Link', ['<http://localhost/>', '<http://localhost:3000/>']);\n   * this.append('Set-Cookie', 'foo=bar; Path=/; HttpOnly');\n   * this.append('Warning', '199 Miscellaneous warning');\n   * ```\n   *\n   * @param {String} field\n   * @param {String|Array} val\n   * @api public\n   */\n\n  append(field, val) {\n    const prev = this.get(field);\n\n    if (prev) {\n      val = Array.isArray(prev)\n        ? prev.concat(val)\n        : [prev].concat(val);\n    }\n\n    return this.set(field, val);\n  },\n\n  /**\n   * Remove header `field`.\n   *\n   * @param {String} name\n   * @api public\n   */\n\n  remove(field) {\n    if (this.headerSent) return;\n\n    this.res.removeHeader(field);\n  },\n\n  /**\n   * Checks if the request is writable.\n   * Tests for the existence of the socket\n   * as node sometimes does not set it.\n   *\n   * @return {Boolean}\n   * @api private\n   */\n\n  get writable() {\n    // can't write any more after response finished\n    // response.writableEnded is available since Node > 12.9\n    // https://nodejs.org/api/http.html#http_response_writableended\n    // response.finished is undocumented feature of previous Node versions\n    // https://stackoverflow.com/questions/16254385/undocumented-response-finished-in-node-js\n    if (this.res.writableEnded || this.res.finished) return false;\n\n    const socket = this.res.socket;\n    // There are already pending outgoing res, but still writable\n    // https://github.com/nodejs/node/blob/v4.4.7/lib/_http_server.js#L486\n    if (!socket) return true;\n    return socket.writable;\n  },\n\n  /**\n   * Inspect implementation.\n   *\n   * @return {Object}\n   * @api public\n   */\n\n  inspect() {\n    if (!this.res) return;\n    const o = this.toJSON();\n    o.body = this.body;\n    return o;\n  },\n\n  /**\n   * Return JSON representation.\n   *\n   * @return {Object}\n   * @api public\n   */\n\n  toJSON() {\n    return only(this, [\n      'status',\n      'message',\n      'header'\n    ]);\n  },\n\n  /**\n   * Flush any set headers and begin the body\n   */\n\n  flushHeaders() {\n    this.res.flushHeaders();\n  }\n};\n\n/**\n * Custom inspection implementation for node 6+.\n *\n * @return {Object}\n * @api public\n */\n\n/* istanbul ignore else */\nif (util.inspect.custom) {\n  module.exports[util.inspect.custom] = module.exports.inspect;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}