{"ast":null,"code":"'use strict';\n\nconst AuthProvider = require('./auth_provider').AuthProvider;\n\nclass X509 extends AuthProvider {\n  prepare(handshakeDoc, authContext, callback) {\n    const credentials = authContext.credentials;\n    Object.assign(handshakeDoc, {\n      speculativeAuthenticate: x509AuthenticateCommand(credentials)\n    });\n    callback(undefined, handshakeDoc);\n  }\n\n  auth(authContext, callback) {\n    const connection = authContext.connection;\n    const credentials = authContext.credentials;\n    const response = authContext.response;\n\n    if (response.speculativeAuthenticate) {\n      return callback();\n    }\n\n    connection.command('$external.$cmd', x509AuthenticateCommand(credentials), callback);\n  }\n\n}\n\nfunction x509AuthenticateCommand(credentials) {\n  const command = {\n    authenticate: 1,\n    mechanism: 'MONGODB-X509'\n  };\n\n  if (credentials.username) {\n    Object.assign(command, {\n      user: credentials.username\n    });\n  }\n\n  return command;\n}\n\nmodule.exports = X509;","map":{"version":3,"names":["AuthProvider","require","X509","prepare","handshakeDoc","authContext","callback","credentials","Object","assign","speculativeAuthenticate","x509AuthenticateCommand","undefined","auth","connection","response","command","authenticate","mechanism","username","user","module","exports"],"sources":["C:/Users/Administrator/Desktop/webAPI work/web/dog-website/node_modules/koa-mongo/node_modules/mongodb/lib/core/auth/x509.js"],"sourcesContent":["'use strict';\nconst AuthProvider = require('./auth_provider').AuthProvider;\n\nclass X509 extends AuthProvider {\n  prepare(handshakeDoc, authContext, callback) {\n    const credentials = authContext.credentials;\n    Object.assign(handshakeDoc, {\n      speculativeAuthenticate: x509AuthenticateCommand(credentials)\n    });\n\n    callback(undefined, handshakeDoc);\n  }\n\n  auth(authContext, callback) {\n    const connection = authContext.connection;\n    const credentials = authContext.credentials;\n    const response = authContext.response;\n    if (response.speculativeAuthenticate) {\n      return callback();\n    }\n\n    connection.command('$external.$cmd', x509AuthenticateCommand(credentials), callback);\n  }\n}\n\nfunction x509AuthenticateCommand(credentials) {\n  const command = { authenticate: 1, mechanism: 'MONGODB-X509' };\n  if (credentials.username) {\n    Object.assign(command, { user: credentials.username });\n  }\n\n  return command;\n}\n\nmodule.exports = X509;\n"],"mappings":"AAAA;;AACA,MAAMA,YAAY,GAAGC,OAAO,CAAC,iBAAD,CAAP,CAA2BD,YAAhD;;AAEA,MAAME,IAAN,SAAmBF,YAAnB,CAAgC;EAC9BG,OAAO,CAACC,YAAD,EAAeC,WAAf,EAA4BC,QAA5B,EAAsC;IAC3C,MAAMC,WAAW,GAAGF,WAAW,CAACE,WAAhC;IACAC,MAAM,CAACC,MAAP,CAAcL,YAAd,EAA4B;MAC1BM,uBAAuB,EAAEC,uBAAuB,CAACJ,WAAD;IADtB,CAA5B;IAIAD,QAAQ,CAACM,SAAD,EAAYR,YAAZ,CAAR;EACD;;EAEDS,IAAI,CAACR,WAAD,EAAcC,QAAd,EAAwB;IAC1B,MAAMQ,UAAU,GAAGT,WAAW,CAACS,UAA/B;IACA,MAAMP,WAAW,GAAGF,WAAW,CAACE,WAAhC;IACA,MAAMQ,QAAQ,GAAGV,WAAW,CAACU,QAA7B;;IACA,IAAIA,QAAQ,CAACL,uBAAb,EAAsC;MACpC,OAAOJ,QAAQ,EAAf;IACD;;IAEDQ,UAAU,CAACE,OAAX,CAAmB,gBAAnB,EAAqCL,uBAAuB,CAACJ,WAAD,CAA5D,EAA2ED,QAA3E;EACD;;AAnB6B;;AAsBhC,SAASK,uBAAT,CAAiCJ,WAAjC,EAA8C;EAC5C,MAAMS,OAAO,GAAG;IAAEC,YAAY,EAAE,CAAhB;IAAmBC,SAAS,EAAE;EAA9B,CAAhB;;EACA,IAAIX,WAAW,CAACY,QAAhB,EAA0B;IACxBX,MAAM,CAACC,MAAP,CAAcO,OAAd,EAAuB;MAAEI,IAAI,EAAEb,WAAW,CAACY;IAApB,CAAvB;EACD;;EAED,OAAOH,OAAP;AACD;;AAEDK,MAAM,CAACC,OAAP,GAAiBpB,IAAjB"},"metadata":{},"sourceType":"script"}