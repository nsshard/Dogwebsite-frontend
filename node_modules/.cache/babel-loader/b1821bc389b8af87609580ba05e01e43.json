{"ast":null,"code":"'use strict';\n\nconst ReadPreference = require('./core').ReadPreference,\n      parser = require('url'),\n      f = require('util').format,\n      Logger = require('./core').Logger,\n      dns = require('dns');\n\nconst ReadConcern = require('./read_concern');\n\nmodule.exports = function (url, options, callback) {\n  if (typeof options === 'function') callback = options, options = {};\n  options = options || {};\n  let result;\n\n  try {\n    result = parser.parse(url, true);\n  } catch (e) {\n    return callback(new Error('URL malformed, cannot be parsed'));\n  }\n\n  if (result.protocol !== 'mongodb:' && result.protocol !== 'mongodb+srv:') {\n    return callback(new Error('Invalid schema, expected `mongodb` or `mongodb+srv`'));\n  }\n\n  if (result.protocol === 'mongodb:') {\n    return parseHandler(url, options, callback);\n  } // Otherwise parse this as an SRV record\n\n\n  if (result.hostname.split('.').length < 3) {\n    return callback(new Error('URI does not have hostname, domain name and tld'));\n  }\n\n  result.domainLength = result.hostname.split('.').length;\n\n  if (result.pathname && result.pathname.match(',')) {\n    return callback(new Error('Invalid URI, cannot contain multiple hostnames'));\n  }\n\n  if (result.port) {\n    return callback(new Error('Ports not accepted with `mongodb+srv` URIs'));\n  }\n\n  let srvAddress = `_mongodb._tcp.${result.host}`;\n  dns.resolveSrv(srvAddress, function (err, addresses) {\n    if (err) return callback(err);\n\n    if (addresses.length === 0) {\n      return callback(new Error('No addresses found at host'));\n    }\n\n    for (let i = 0; i < addresses.length; i++) {\n      if (!matchesParentDomain(addresses[i].name, result.hostname, result.domainLength)) {\n        return callback(new Error('Server record does not share hostname with parent URI'));\n      }\n    }\n\n    let base = result.auth ? `mongodb://${result.auth}@` : `mongodb://`;\n    let connectionStrings = addresses.map(function (address, i) {\n      if (i === 0) return `${base}${address.name}:${address.port}`;else return `${address.name}:${address.port}`;\n    });\n    let connectionString = connectionStrings.join(',') + '/';\n    let connectionStringOptions = []; // Add the default database if needed\n\n    if (result.path) {\n      let defaultDb = result.path.slice(1);\n\n      if (defaultDb.indexOf('?') !== -1) {\n        defaultDb = defaultDb.slice(0, defaultDb.indexOf('?'));\n      }\n\n      connectionString += defaultDb;\n    } // Default to SSL true\n\n\n    if (!options.ssl && !result.search) {\n      connectionStringOptions.push('ssl=true');\n    } else if (!options.ssl && result.search && !result.search.match('ssl')) {\n      connectionStringOptions.push('ssl=true');\n    } // Keep original uri options\n\n\n    if (result.search) {\n      connectionStringOptions.push(result.search.replace('?', ''));\n    }\n\n    dns.resolveTxt(result.host, function (err, record) {\n      if (err && err.code !== 'ENODATA') return callback(err);\n      if (err && err.code === 'ENODATA') record = null;\n\n      if (record) {\n        if (record.length > 1) {\n          return callback(new Error('Multiple text records not allowed'));\n        }\n\n        record = record[0];\n        if (record.length > 1) record = record.join('');else record = record[0];\n\n        if (!record.includes('authSource') && !record.includes('replicaSet')) {\n          return callback(new Error('Text record must only set `authSource` or `replicaSet`'));\n        }\n\n        connectionStringOptions.push(record);\n      } // Add any options to the connection string\n\n\n      if (connectionStringOptions.length) {\n        connectionString += `?${connectionStringOptions.join('&')}`;\n      }\n\n      parseHandler(connectionString, options, callback);\n    });\n  });\n};\n\nfunction matchesParentDomain(srvAddress, parentDomain) {\n  let regex = /^.*?\\./;\n  let srv = `.${srvAddress.replace(regex, '')}`;\n  let parent = `.${parentDomain.replace(regex, '')}`;\n  if (srv.endsWith(parent)) return true;else return false;\n}\n\nfunction parseHandler(address, options, callback) {\n  let result, err;\n\n  try {\n    result = parseConnectionString(address, options);\n  } catch (e) {\n    err = e;\n  }\n\n  return err ? callback(err, null) : callback(null, result);\n}\n\nfunction parseConnectionString(url, options) {\n  // Variables\n  let connection_part = '';\n  let auth_part = '';\n  let query_string_part = '';\n  let dbName = 'admin'; // Url parser result\n\n  let result = parser.parse(url, true);\n\n  if ((result.hostname == null || result.hostname === '') && url.indexOf('.sock') === -1) {\n    throw new Error('No hostname or hostnames provided in connection string');\n  }\n\n  if (result.port === '0') {\n    throw new Error('Invalid port (zero) with hostname');\n  }\n\n  if (!isNaN(parseInt(result.port, 10)) && parseInt(result.port, 10) > 65535) {\n    throw new Error('Invalid port (larger than 65535) with hostname');\n  }\n\n  if (result.path && result.path.length > 0 && result.path[0] !== '/' && url.indexOf('.sock') === -1) {\n    throw new Error('Missing delimiting slash between hosts and options');\n  }\n\n  if (result.query) {\n    for (let name in result.query) {\n      if (name.indexOf('::') !== -1) {\n        throw new Error('Double colon in host identifier');\n      }\n\n      if (result.query[name] === '') {\n        throw new Error('Query parameter ' + name + ' is an incomplete value pair');\n      }\n    }\n  }\n\n  if (result.auth) {\n    let parts = result.auth.split(':');\n\n    if (url.indexOf(result.auth) !== -1 && parts.length > 2) {\n      throw new Error('Username with password containing an unescaped colon');\n    }\n\n    if (url.indexOf(result.auth) !== -1 && result.auth.indexOf('@') !== -1) {\n      throw new Error('Username containing an unescaped at-sign');\n    }\n  } // Remove query\n\n\n  let clean = url.split('?').shift(); // Extract the list of hosts\n\n  let strings = clean.split(',');\n  let hosts = [];\n\n  for (let i = 0; i < strings.length; i++) {\n    let hostString = strings[i];\n\n    if (hostString.indexOf('mongodb') !== -1) {\n      if (hostString.indexOf('@') !== -1) {\n        hosts.push(hostString.split('@').pop());\n      } else {\n        hosts.push(hostString.substr('mongodb://'.length));\n      }\n    } else if (hostString.indexOf('/') !== -1) {\n      hosts.push(hostString.split('/').shift());\n    } else if (hostString.indexOf('/') === -1) {\n      hosts.push(hostString.trim());\n    }\n  }\n\n  for (let i = 0; i < hosts.length; i++) {\n    let r = parser.parse(f('mongodb://%s', hosts[i].trim()));\n    if (r.path && r.path.indexOf('.sock') !== -1) continue;\n\n    if (r.path && r.path.indexOf(':') !== -1) {\n      // Not connecting to a socket so check for an extra slash in the hostname.\n      // Using String#split as perf is better than match.\n      if (r.path.split('/').length > 1 && r.path.indexOf('::') === -1) {\n        throw new Error('Slash in host identifier');\n      } else {\n        throw new Error('Double colon in host identifier');\n      }\n    }\n  } // If we have a ? mark cut the query elements off\n\n\n  if (url.indexOf('?') !== -1) {\n    query_string_part = url.substr(url.indexOf('?') + 1);\n    connection_part = url.substring('mongodb://'.length, url.indexOf('?'));\n  } else {\n    connection_part = url.substring('mongodb://'.length);\n  } // Check if we have auth params\n\n\n  if (connection_part.indexOf('@') !== -1) {\n    auth_part = connection_part.split('@')[0];\n    connection_part = connection_part.split('@')[1];\n  } // Check there is not more than one unescaped slash\n\n\n  if (connection_part.split('/').length > 2) {\n    throw new Error(\"Unsupported host '\" + connection_part.split('?')[0] + \"', hosts must be URL encoded and contain at most one unencoded slash\");\n  } // Check if the connection string has a db\n\n\n  if (connection_part.indexOf('.sock') !== -1) {\n    if (connection_part.indexOf('.sock/') !== -1) {\n      dbName = connection_part.split('.sock/')[1]; // Check if multiple database names provided, or just an illegal trailing backslash\n\n      if (dbName.indexOf('/') !== -1) {\n        if (dbName.split('/').length === 2 && dbName.split('/')[1].length === 0) {\n          throw new Error('Illegal trailing backslash after database name');\n        }\n\n        throw new Error('More than 1 database name in URL');\n      }\n\n      connection_part = connection_part.split('/', connection_part.indexOf('.sock') + '.sock'.length);\n    }\n  } else if (connection_part.indexOf('/') !== -1) {\n    // Check if multiple database names provided, or just an illegal trailing backslash\n    if (connection_part.split('/').length > 2) {\n      if (connection_part.split('/')[2].length === 0) {\n        throw new Error('Illegal trailing backslash after database name');\n      }\n\n      throw new Error('More than 1 database name in URL');\n    }\n\n    dbName = connection_part.split('/')[1];\n    connection_part = connection_part.split('/')[0];\n  } // URI decode the host information\n\n\n  connection_part = decodeURIComponent(connection_part); // Result object\n\n  let object = {}; // Pick apart the authentication part of the string\n\n  let authPart = auth_part || '';\n  let auth = authPart.split(':', 2); // Decode the authentication URI components and verify integrity\n\n  let user = decodeURIComponent(auth[0]);\n\n  if (auth[0] !== encodeURIComponent(user)) {\n    throw new Error('Username contains an illegal unescaped character');\n  }\n\n  auth[0] = user;\n\n  if (auth[1]) {\n    let pass = decodeURIComponent(auth[1]);\n\n    if (auth[1] !== encodeURIComponent(pass)) {\n      throw new Error('Password contains an illegal unescaped character');\n    }\n\n    auth[1] = pass;\n  } // Add auth to final object if we have 2 elements\n\n\n  if (auth.length === 2) object.auth = {\n    user: auth[0],\n    password: auth[1]\n  }; // if user provided auth options, use that\n\n  if (options && options.auth != null) object.auth = options.auth; // Variables used for temporary storage\n\n  let hostPart;\n  let urlOptions;\n  let servers;\n  let compression;\n  let serverOptions = {\n    socketOptions: {}\n  };\n  let dbOptions = {\n    read_preference_tags: []\n  };\n  let replSetServersOptions = {\n    socketOptions: {}\n  };\n  let mongosOptions = {\n    socketOptions: {}\n  }; // Add server options to final object\n\n  object.server_options = serverOptions;\n  object.db_options = dbOptions;\n  object.rs_options = replSetServersOptions;\n  object.mongos_options = mongosOptions; // Let's check if we are using a domain socket\n\n  if (url.match(/\\.sock/)) {\n    // Split out the socket part\n    let domainSocket = url.substring(url.indexOf('mongodb://') + 'mongodb://'.length, url.lastIndexOf('.sock') + '.sock'.length); // Clean out any auth stuff if any\n\n    if (domainSocket.indexOf('@') !== -1) domainSocket = domainSocket.split('@')[1];\n    domainSocket = decodeURIComponent(domainSocket);\n    servers = [{\n      domain_socket: domainSocket\n    }];\n  } else {\n    // Split up the db\n    hostPart = connection_part; // Deduplicate servers\n\n    let deduplicatedServers = {}; // Parse all server results\n\n    servers = hostPart.split(',').map(function (h) {\n      let _host, _port, ipv6match; //check if it matches [IPv6]:port, where the port number is optional\n\n\n      if (ipv6match = /\\[([^\\]]+)\\](?::(.+))?/.exec(h)) {\n        _host = ipv6match[1];\n        _port = parseInt(ipv6match[2], 10) || 27017;\n      } else {\n        //otherwise assume it's IPv4, or plain hostname\n        let hostPort = h.split(':', 2);\n        _host = hostPort[0] || 'localhost';\n        _port = hostPort[1] != null ? parseInt(hostPort[1], 10) : 27017; // Check for localhost?safe=true style case\n\n        if (_host.indexOf('?') !== -1) _host = _host.split(/\\?/)[0];\n      } // No entry returned for duplicate server\n\n\n      if (deduplicatedServers[_host + '_' + _port]) return null;\n      deduplicatedServers[_host + '_' + _port] = 1; // Return the mapped object\n\n      return {\n        host: _host,\n        port: _port\n      };\n    }).filter(function (x) {\n      return x != null;\n    });\n  } // Get the db name\n\n\n  object.dbName = dbName || 'admin'; // Split up all the options\n\n  urlOptions = (query_string_part || '').split(/[&;]/); // Ugh, we have to figure out which options go to which constructor manually.\n\n  urlOptions.forEach(function (opt) {\n    if (!opt) return;\n    var splitOpt = opt.split('='),\n        name = splitOpt[0],\n        value = splitOpt[1]; // Options implementations\n\n    switch (name) {\n      case 'slaveOk':\n      case 'slave_ok':\n        serverOptions.slave_ok = value === 'true';\n        dbOptions.slaveOk = value === 'true';\n        break;\n\n      case 'maxPoolSize':\n      case 'poolSize':\n        serverOptions.poolSize = parseInt(value, 10);\n        replSetServersOptions.poolSize = parseInt(value, 10);\n        break;\n\n      case 'appname':\n        object.appname = decodeURIComponent(value);\n        break;\n\n      case 'autoReconnect':\n      case 'auto_reconnect':\n        serverOptions.auto_reconnect = value === 'true';\n        break;\n\n      case 'ssl':\n        if (value === 'prefer') {\n          serverOptions.ssl = value;\n          replSetServersOptions.ssl = value;\n          mongosOptions.ssl = value;\n          break;\n        }\n\n        serverOptions.ssl = value === 'true';\n        replSetServersOptions.ssl = value === 'true';\n        mongosOptions.ssl = value === 'true';\n        break;\n\n      case 'sslValidate':\n        serverOptions.sslValidate = value === 'true';\n        replSetServersOptions.sslValidate = value === 'true';\n        mongosOptions.sslValidate = value === 'true';\n        break;\n\n      case 'replicaSet':\n      case 'rs_name':\n        replSetServersOptions.rs_name = value;\n        break;\n\n      case 'reconnectWait':\n        replSetServersOptions.reconnectWait = parseInt(value, 10);\n        break;\n\n      case 'retries':\n        replSetServersOptions.retries = parseInt(value, 10);\n        break;\n\n      case 'readSecondary':\n      case 'read_secondary':\n        replSetServersOptions.read_secondary = value === 'true';\n        break;\n\n      case 'fsync':\n        dbOptions.fsync = value === 'true';\n        break;\n\n      case 'journal':\n        dbOptions.j = value === 'true';\n        break;\n\n      case 'safe':\n        dbOptions.safe = value === 'true';\n        break;\n\n      case 'nativeParser':\n      case 'native_parser':\n        dbOptions.native_parser = value === 'true';\n        break;\n\n      case 'readConcernLevel':\n        dbOptions.readConcern = new ReadConcern(value);\n        break;\n\n      case 'connectTimeoutMS':\n        serverOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        replSetServersOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        mongosOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        break;\n\n      case 'socketTimeoutMS':\n        serverOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        replSetServersOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        mongosOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        break;\n\n      case 'w':\n        dbOptions.w = parseInt(value, 10);\n        if (isNaN(dbOptions.w)) dbOptions.w = value;\n        break;\n\n      case 'authSource':\n        dbOptions.authSource = value;\n        break;\n\n      case 'gssapiServiceName':\n        dbOptions.gssapiServiceName = value;\n        break;\n\n      case 'authMechanism':\n        if (value === 'GSSAPI') {\n          // If no password provided decode only the principal\n          if (object.auth == null) {\n            let urlDecodeAuthPart = decodeURIComponent(authPart);\n            if (urlDecodeAuthPart.indexOf('@') === -1) throw new Error('GSSAPI requires a provided principal');\n            object.auth = {\n              user: urlDecodeAuthPart,\n              password: null\n            };\n          } else {\n            object.auth.user = decodeURIComponent(object.auth.user);\n          }\n        } else if (value === 'MONGODB-X509') {\n          object.auth = {\n            user: decodeURIComponent(authPart)\n          };\n        } // Only support GSSAPI or MONGODB-CR for now\n\n\n        if (value !== 'GSSAPI' && value !== 'MONGODB-X509' && value !== 'MONGODB-CR' && value !== 'DEFAULT' && value !== 'SCRAM-SHA-1' && value !== 'SCRAM-SHA-256' && value !== 'PLAIN') throw new Error('Only DEFAULT, GSSAPI, PLAIN, MONGODB-X509, or SCRAM-SHA-1 is supported by authMechanism'); // Authentication mechanism\n\n        dbOptions.authMechanism = value;\n        break;\n\n      case 'authMechanismProperties':\n        {\n          // Split up into key, value pairs\n          let values = value.split(',');\n          let o = {}; // For each value split into key, value\n\n          values.forEach(function (x) {\n            let v = x.split(':');\n            o[v[0]] = v[1];\n          }); // Set all authMechanismProperties\n\n          dbOptions.authMechanismProperties = o; // Set the service name value\n\n          if (typeof o.SERVICE_NAME === 'string') dbOptions.gssapiServiceName = o.SERVICE_NAME;\n          if (typeof o.SERVICE_REALM === 'string') dbOptions.gssapiServiceRealm = o.SERVICE_REALM;\n          if (typeof o.CANONICALIZE_HOST_NAME === 'string') dbOptions.gssapiCanonicalizeHostName = o.CANONICALIZE_HOST_NAME === 'true' ? true : false;\n        }\n        break;\n\n      case 'wtimeoutMS':\n        dbOptions.wtimeout = parseInt(value, 10);\n        break;\n\n      case 'readPreference':\n        if (!ReadPreference.isValid(value)) throw new Error('readPreference must be either primary/primaryPreferred/secondary/secondaryPreferred/nearest');\n        dbOptions.readPreference = value;\n        break;\n\n      case 'maxStalenessSeconds':\n        dbOptions.maxStalenessSeconds = parseInt(value, 10);\n        break;\n\n      case 'readPreferenceTags':\n        {\n          // Decode the value\n          value = decodeURIComponent(value); // Contains the tag object\n\n          let tagObject = {};\n\n          if (value == null || value === '') {\n            dbOptions.read_preference_tags.push(tagObject);\n            break;\n          } // Split up the tags\n\n\n          let tags = value.split(/,/);\n\n          for (let i = 0; i < tags.length; i++) {\n            let parts = tags[i].trim().split(/:/);\n            tagObject[parts[0]] = parts[1];\n          } // Set the preferences tags\n\n\n          dbOptions.read_preference_tags.push(tagObject);\n        }\n        break;\n\n      case 'compressors':\n        {\n          compression = serverOptions.compression || {};\n          let compressors = value.split(',');\n\n          if (!compressors.every(function (compressor) {\n            return compressor === 'snappy' || compressor === 'zlib';\n          })) {\n            throw new Error('Compressors must be at least one of snappy or zlib');\n          }\n\n          compression.compressors = compressors;\n          serverOptions.compression = compression;\n        }\n        break;\n\n      case 'zlibCompressionLevel':\n        {\n          compression = serverOptions.compression || {};\n          let zlibCompressionLevel = parseInt(value, 10);\n\n          if (zlibCompressionLevel < -1 || zlibCompressionLevel > 9) {\n            throw new Error('zlibCompressionLevel must be an integer between -1 and 9');\n          }\n\n          compression.zlibCompressionLevel = zlibCompressionLevel;\n          serverOptions.compression = compression;\n        }\n        break;\n\n      case 'retryWrites':\n        dbOptions.retryWrites = value === 'true';\n        break;\n\n      case 'minSize':\n        dbOptions.minSize = parseInt(value, 10);\n        break;\n\n      default:\n        {\n          let logger = Logger('URL Parser');\n          logger.warn(`${name} is not supported as a connection string option`);\n        }\n        break;\n    }\n  }); // No tags: should be null (not [])\n\n  if (dbOptions.read_preference_tags.length === 0) {\n    dbOptions.read_preference_tags = null;\n  } // Validate if there are an invalid write concern combinations\n\n\n  if ((dbOptions.w === -1 || dbOptions.w === 0) && (dbOptions.journal === true || dbOptions.fsync === true || dbOptions.safe === true)) throw new Error('w set to -1 or 0 cannot be combined with safe/w/journal/fsync'); // If no read preference set it to primary\n\n  if (!dbOptions.readPreference) {\n    dbOptions.readPreference = 'primary';\n  } // make sure that user-provided options are applied with priority\n\n\n  dbOptions = Object.assign(dbOptions, options); // Add servers to result\n\n  object.servers = servers; // Returned parsed object\n\n  return object;\n}","map":{"version":3,"names":["ReadPreference","require","parser","f","format","Logger","dns","ReadConcern","module","exports","url","options","callback","result","parse","e","Error","protocol","parseHandler","hostname","split","length","domainLength","pathname","match","port","srvAddress","host","resolveSrv","err","addresses","i","matchesParentDomain","name","base","auth","connectionStrings","map","address","connectionString","join","connectionStringOptions","path","defaultDb","slice","indexOf","ssl","search","push","replace","resolveTxt","record","code","includes","parentDomain","regex","srv","parent","endsWith","parseConnectionString","connection_part","auth_part","query_string_part","dbName","isNaN","parseInt","query","parts","clean","shift","strings","hosts","hostString","pop","substr","trim","r","substring","decodeURIComponent","object","authPart","user","encodeURIComponent","pass","password","hostPart","urlOptions","servers","compression","serverOptions","socketOptions","dbOptions","read_preference_tags","replSetServersOptions","mongosOptions","server_options","db_options","rs_options","mongos_options","domainSocket","lastIndexOf","domain_socket","deduplicatedServers","h","_host","_port","ipv6match","exec","hostPort","filter","x","forEach","opt","splitOpt","value","slave_ok","slaveOk","poolSize","appname","auto_reconnect","sslValidate","rs_name","reconnectWait","retries","read_secondary","fsync","j","safe","native_parser","readConcern","connectTimeoutMS","socketTimeoutMS","w","authSource","gssapiServiceName","urlDecodeAuthPart","authMechanism","values","o","v","authMechanismProperties","SERVICE_NAME","SERVICE_REALM","gssapiServiceRealm","CANONICALIZE_HOST_NAME","gssapiCanonicalizeHostName","wtimeout","isValid","readPreference","maxStalenessSeconds","tagObject","tags","compressors","every","compressor","zlibCompressionLevel","retryWrites","minSize","logger","warn","journal","Object","assign"],"sources":["C:/Users/Administrator/Desktop/webAPI work/web/dog-website/node_modules/koa-mongo/node_modules/mongodb/lib/url_parser.js"],"sourcesContent":["'use strict';\n\nconst ReadPreference = require('./core').ReadPreference,\n  parser = require('url'),\n  f = require('util').format,\n  Logger = require('./core').Logger,\n  dns = require('dns');\nconst ReadConcern = require('./read_concern');\n\nmodule.exports = function(url, options, callback) {\n  if (typeof options === 'function') (callback = options), (options = {});\n  options = options || {};\n\n  let result;\n  try {\n    result = parser.parse(url, true);\n  } catch (e) {\n    return callback(new Error('URL malformed, cannot be parsed'));\n  }\n\n  if (result.protocol !== 'mongodb:' && result.protocol !== 'mongodb+srv:') {\n    return callback(new Error('Invalid schema, expected `mongodb` or `mongodb+srv`'));\n  }\n\n  if (result.protocol === 'mongodb:') {\n    return parseHandler(url, options, callback);\n  }\n\n  // Otherwise parse this as an SRV record\n  if (result.hostname.split('.').length < 3) {\n    return callback(new Error('URI does not have hostname, domain name and tld'));\n  }\n\n  result.domainLength = result.hostname.split('.').length;\n\n  if (result.pathname && result.pathname.match(',')) {\n    return callback(new Error('Invalid URI, cannot contain multiple hostnames'));\n  }\n\n  if (result.port) {\n    return callback(new Error('Ports not accepted with `mongodb+srv` URIs'));\n  }\n\n  let srvAddress = `_mongodb._tcp.${result.host}`;\n  dns.resolveSrv(srvAddress, function(err, addresses) {\n    if (err) return callback(err);\n\n    if (addresses.length === 0) {\n      return callback(new Error('No addresses found at host'));\n    }\n\n    for (let i = 0; i < addresses.length; i++) {\n      if (!matchesParentDomain(addresses[i].name, result.hostname, result.domainLength)) {\n        return callback(new Error('Server record does not share hostname with parent URI'));\n      }\n    }\n\n    let base = result.auth ? `mongodb://${result.auth}@` : `mongodb://`;\n    let connectionStrings = addresses.map(function(address, i) {\n      if (i === 0) return `${base}${address.name}:${address.port}`;\n      else return `${address.name}:${address.port}`;\n    });\n\n    let connectionString = connectionStrings.join(',') + '/';\n    let connectionStringOptions = [];\n\n    // Add the default database if needed\n    if (result.path) {\n      let defaultDb = result.path.slice(1);\n      if (defaultDb.indexOf('?') !== -1) {\n        defaultDb = defaultDb.slice(0, defaultDb.indexOf('?'));\n      }\n\n      connectionString += defaultDb;\n    }\n\n    // Default to SSL true\n    if (!options.ssl && !result.search) {\n      connectionStringOptions.push('ssl=true');\n    } else if (!options.ssl && result.search && !result.search.match('ssl')) {\n      connectionStringOptions.push('ssl=true');\n    }\n\n    // Keep original uri options\n    if (result.search) {\n      connectionStringOptions.push(result.search.replace('?', ''));\n    }\n\n    dns.resolveTxt(result.host, function(err, record) {\n      if (err && err.code !== 'ENODATA') return callback(err);\n      if (err && err.code === 'ENODATA') record = null;\n\n      if (record) {\n        if (record.length > 1) {\n          return callback(new Error('Multiple text records not allowed'));\n        }\n\n        record = record[0];\n        if (record.length > 1) record = record.join('');\n        else record = record[0];\n\n        if (!record.includes('authSource') && !record.includes('replicaSet')) {\n          return callback(new Error('Text record must only set `authSource` or `replicaSet`'));\n        }\n\n        connectionStringOptions.push(record);\n      }\n\n      // Add any options to the connection string\n      if (connectionStringOptions.length) {\n        connectionString += `?${connectionStringOptions.join('&')}`;\n      }\n\n      parseHandler(connectionString, options, callback);\n    });\n  });\n};\n\nfunction matchesParentDomain(srvAddress, parentDomain) {\n  let regex = /^.*?\\./;\n  let srv = `.${srvAddress.replace(regex, '')}`;\n  let parent = `.${parentDomain.replace(regex, '')}`;\n  if (srv.endsWith(parent)) return true;\n  else return false;\n}\n\nfunction parseHandler(address, options, callback) {\n  let result, err;\n  try {\n    result = parseConnectionString(address, options);\n  } catch (e) {\n    err = e;\n  }\n\n  return err ? callback(err, null) : callback(null, result);\n}\n\nfunction parseConnectionString(url, options) {\n  // Variables\n  let connection_part = '';\n  let auth_part = '';\n  let query_string_part = '';\n  let dbName = 'admin';\n\n  // Url parser result\n  let result = parser.parse(url, true);\n  if ((result.hostname == null || result.hostname === '') && url.indexOf('.sock') === -1) {\n    throw new Error('No hostname or hostnames provided in connection string');\n  }\n\n  if (result.port === '0') {\n    throw new Error('Invalid port (zero) with hostname');\n  }\n\n  if (!isNaN(parseInt(result.port, 10)) && parseInt(result.port, 10) > 65535) {\n    throw new Error('Invalid port (larger than 65535) with hostname');\n  }\n\n  if (\n    result.path &&\n    result.path.length > 0 &&\n    result.path[0] !== '/' &&\n    url.indexOf('.sock') === -1\n  ) {\n    throw new Error('Missing delimiting slash between hosts and options');\n  }\n\n  if (result.query) {\n    for (let name in result.query) {\n      if (name.indexOf('::') !== -1) {\n        throw new Error('Double colon in host identifier');\n      }\n\n      if (result.query[name] === '') {\n        throw new Error('Query parameter ' + name + ' is an incomplete value pair');\n      }\n    }\n  }\n\n  if (result.auth) {\n    let parts = result.auth.split(':');\n    if (url.indexOf(result.auth) !== -1 && parts.length > 2) {\n      throw new Error('Username with password containing an unescaped colon');\n    }\n\n    if (url.indexOf(result.auth) !== -1 && result.auth.indexOf('@') !== -1) {\n      throw new Error('Username containing an unescaped at-sign');\n    }\n  }\n\n  // Remove query\n  let clean = url.split('?').shift();\n\n  // Extract the list of hosts\n  let strings = clean.split(',');\n  let hosts = [];\n\n  for (let i = 0; i < strings.length; i++) {\n    let hostString = strings[i];\n\n    if (hostString.indexOf('mongodb') !== -1) {\n      if (hostString.indexOf('@') !== -1) {\n        hosts.push(hostString.split('@').pop());\n      } else {\n        hosts.push(hostString.substr('mongodb://'.length));\n      }\n    } else if (hostString.indexOf('/') !== -1) {\n      hosts.push(hostString.split('/').shift());\n    } else if (hostString.indexOf('/') === -1) {\n      hosts.push(hostString.trim());\n    }\n  }\n\n  for (let i = 0; i < hosts.length; i++) {\n    let r = parser.parse(f('mongodb://%s', hosts[i].trim()));\n    if (r.path && r.path.indexOf('.sock') !== -1) continue;\n    if (r.path && r.path.indexOf(':') !== -1) {\n      // Not connecting to a socket so check for an extra slash in the hostname.\n      // Using String#split as perf is better than match.\n      if (r.path.split('/').length > 1 && r.path.indexOf('::') === -1) {\n        throw new Error('Slash in host identifier');\n      } else {\n        throw new Error('Double colon in host identifier');\n      }\n    }\n  }\n\n  // If we have a ? mark cut the query elements off\n  if (url.indexOf('?') !== -1) {\n    query_string_part = url.substr(url.indexOf('?') + 1);\n    connection_part = url.substring('mongodb://'.length, url.indexOf('?'));\n  } else {\n    connection_part = url.substring('mongodb://'.length);\n  }\n\n  // Check if we have auth params\n  if (connection_part.indexOf('@') !== -1) {\n    auth_part = connection_part.split('@')[0];\n    connection_part = connection_part.split('@')[1];\n  }\n\n  // Check there is not more than one unescaped slash\n  if (connection_part.split('/').length > 2) {\n    throw new Error(\n      \"Unsupported host '\" +\n        connection_part.split('?')[0] +\n        \"', hosts must be URL encoded and contain at most one unencoded slash\"\n    );\n  }\n\n  // Check if the connection string has a db\n  if (connection_part.indexOf('.sock') !== -1) {\n    if (connection_part.indexOf('.sock/') !== -1) {\n      dbName = connection_part.split('.sock/')[1];\n      // Check if multiple database names provided, or just an illegal trailing backslash\n      if (dbName.indexOf('/') !== -1) {\n        if (dbName.split('/').length === 2 && dbName.split('/')[1].length === 0) {\n          throw new Error('Illegal trailing backslash after database name');\n        }\n        throw new Error('More than 1 database name in URL');\n      }\n      connection_part = connection_part.split(\n        '/',\n        connection_part.indexOf('.sock') + '.sock'.length\n      );\n    }\n  } else if (connection_part.indexOf('/') !== -1) {\n    // Check if multiple database names provided, or just an illegal trailing backslash\n    if (connection_part.split('/').length > 2) {\n      if (connection_part.split('/')[2].length === 0) {\n        throw new Error('Illegal trailing backslash after database name');\n      }\n      throw new Error('More than 1 database name in URL');\n    }\n    dbName = connection_part.split('/')[1];\n    connection_part = connection_part.split('/')[0];\n  }\n\n  // URI decode the host information\n  connection_part = decodeURIComponent(connection_part);\n\n  // Result object\n  let object = {};\n\n  // Pick apart the authentication part of the string\n  let authPart = auth_part || '';\n  let auth = authPart.split(':', 2);\n\n  // Decode the authentication URI components and verify integrity\n  let user = decodeURIComponent(auth[0]);\n  if (auth[0] !== encodeURIComponent(user)) {\n    throw new Error('Username contains an illegal unescaped character');\n  }\n  auth[0] = user;\n\n  if (auth[1]) {\n    let pass = decodeURIComponent(auth[1]);\n    if (auth[1] !== encodeURIComponent(pass)) {\n      throw new Error('Password contains an illegal unescaped character');\n    }\n    auth[1] = pass;\n  }\n\n  // Add auth to final object if we have 2 elements\n  if (auth.length === 2) object.auth = { user: auth[0], password: auth[1] };\n  // if user provided auth options, use that\n  if (options && options.auth != null) object.auth = options.auth;\n\n  // Variables used for temporary storage\n  let hostPart;\n  let urlOptions;\n  let servers;\n  let compression;\n  let serverOptions = { socketOptions: {} };\n  let dbOptions = { read_preference_tags: [] };\n  let replSetServersOptions = { socketOptions: {} };\n  let mongosOptions = { socketOptions: {} };\n  // Add server options to final object\n  object.server_options = serverOptions;\n  object.db_options = dbOptions;\n  object.rs_options = replSetServersOptions;\n  object.mongos_options = mongosOptions;\n\n  // Let's check if we are using a domain socket\n  if (url.match(/\\.sock/)) {\n    // Split out the socket part\n    let domainSocket = url.substring(\n      url.indexOf('mongodb://') + 'mongodb://'.length,\n      url.lastIndexOf('.sock') + '.sock'.length\n    );\n    // Clean out any auth stuff if any\n    if (domainSocket.indexOf('@') !== -1) domainSocket = domainSocket.split('@')[1];\n    domainSocket = decodeURIComponent(domainSocket);\n    servers = [{ domain_socket: domainSocket }];\n  } else {\n    // Split up the db\n    hostPart = connection_part;\n    // Deduplicate servers\n    let deduplicatedServers = {};\n\n    // Parse all server results\n    servers = hostPart\n      .split(',')\n      .map(function(h) {\n        let _host, _port, ipv6match;\n        //check if it matches [IPv6]:port, where the port number is optional\n        if ((ipv6match = /\\[([^\\]]+)\\](?::(.+))?/.exec(h))) {\n          _host = ipv6match[1];\n          _port = parseInt(ipv6match[2], 10) || 27017;\n        } else {\n          //otherwise assume it's IPv4, or plain hostname\n          let hostPort = h.split(':', 2);\n          _host = hostPort[0] || 'localhost';\n          _port = hostPort[1] != null ? parseInt(hostPort[1], 10) : 27017;\n          // Check for localhost?safe=true style case\n          if (_host.indexOf('?') !== -1) _host = _host.split(/\\?/)[0];\n        }\n\n        // No entry returned for duplicate server\n        if (deduplicatedServers[_host + '_' + _port]) return null;\n        deduplicatedServers[_host + '_' + _port] = 1;\n\n        // Return the mapped object\n        return { host: _host, port: _port };\n      })\n      .filter(function(x) {\n        return x != null;\n      });\n  }\n\n  // Get the db name\n  object.dbName = dbName || 'admin';\n  // Split up all the options\n  urlOptions = (query_string_part || '').split(/[&;]/);\n  // Ugh, we have to figure out which options go to which constructor manually.\n  urlOptions.forEach(function(opt) {\n    if (!opt) return;\n    var splitOpt = opt.split('='),\n      name = splitOpt[0],\n      value = splitOpt[1];\n\n    // Options implementations\n    switch (name) {\n      case 'slaveOk':\n      case 'slave_ok':\n        serverOptions.slave_ok = value === 'true';\n        dbOptions.slaveOk = value === 'true';\n        break;\n      case 'maxPoolSize':\n      case 'poolSize':\n        serverOptions.poolSize = parseInt(value, 10);\n        replSetServersOptions.poolSize = parseInt(value, 10);\n        break;\n      case 'appname':\n        object.appname = decodeURIComponent(value);\n        break;\n      case 'autoReconnect':\n      case 'auto_reconnect':\n        serverOptions.auto_reconnect = value === 'true';\n        break;\n      case 'ssl':\n        if (value === 'prefer') {\n          serverOptions.ssl = value;\n          replSetServersOptions.ssl = value;\n          mongosOptions.ssl = value;\n          break;\n        }\n        serverOptions.ssl = value === 'true';\n        replSetServersOptions.ssl = value === 'true';\n        mongosOptions.ssl = value === 'true';\n        break;\n      case 'sslValidate':\n        serverOptions.sslValidate = value === 'true';\n        replSetServersOptions.sslValidate = value === 'true';\n        mongosOptions.sslValidate = value === 'true';\n        break;\n      case 'replicaSet':\n      case 'rs_name':\n        replSetServersOptions.rs_name = value;\n        break;\n      case 'reconnectWait':\n        replSetServersOptions.reconnectWait = parseInt(value, 10);\n        break;\n      case 'retries':\n        replSetServersOptions.retries = parseInt(value, 10);\n        break;\n      case 'readSecondary':\n      case 'read_secondary':\n        replSetServersOptions.read_secondary = value === 'true';\n        break;\n      case 'fsync':\n        dbOptions.fsync = value === 'true';\n        break;\n      case 'journal':\n        dbOptions.j = value === 'true';\n        break;\n      case 'safe':\n        dbOptions.safe = value === 'true';\n        break;\n      case 'nativeParser':\n      case 'native_parser':\n        dbOptions.native_parser = value === 'true';\n        break;\n      case 'readConcernLevel':\n        dbOptions.readConcern = new ReadConcern(value);\n        break;\n      case 'connectTimeoutMS':\n        serverOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        replSetServersOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        mongosOptions.socketOptions.connectTimeoutMS = parseInt(value, 10);\n        break;\n      case 'socketTimeoutMS':\n        serverOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        replSetServersOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        mongosOptions.socketOptions.socketTimeoutMS = parseInt(value, 10);\n        break;\n      case 'w':\n        dbOptions.w = parseInt(value, 10);\n        if (isNaN(dbOptions.w)) dbOptions.w = value;\n        break;\n      case 'authSource':\n        dbOptions.authSource = value;\n        break;\n      case 'gssapiServiceName':\n        dbOptions.gssapiServiceName = value;\n        break;\n      case 'authMechanism':\n        if (value === 'GSSAPI') {\n          // If no password provided decode only the principal\n          if (object.auth == null) {\n            let urlDecodeAuthPart = decodeURIComponent(authPart);\n            if (urlDecodeAuthPart.indexOf('@') === -1)\n              throw new Error('GSSAPI requires a provided principal');\n            object.auth = { user: urlDecodeAuthPart, password: null };\n          } else {\n            object.auth.user = decodeURIComponent(object.auth.user);\n          }\n        } else if (value === 'MONGODB-X509') {\n          object.auth = { user: decodeURIComponent(authPart) };\n        }\n\n        // Only support GSSAPI or MONGODB-CR for now\n        if (\n          value !== 'GSSAPI' &&\n          value !== 'MONGODB-X509' &&\n          value !== 'MONGODB-CR' &&\n          value !== 'DEFAULT' &&\n          value !== 'SCRAM-SHA-1' &&\n          value !== 'SCRAM-SHA-256' &&\n          value !== 'PLAIN'\n        )\n          throw new Error(\n            'Only DEFAULT, GSSAPI, PLAIN, MONGODB-X509, or SCRAM-SHA-1 is supported by authMechanism'\n          );\n\n        // Authentication mechanism\n        dbOptions.authMechanism = value;\n        break;\n      case 'authMechanismProperties':\n        {\n          // Split up into key, value pairs\n          let values = value.split(',');\n          let o = {};\n          // For each value split into key, value\n          values.forEach(function(x) {\n            let v = x.split(':');\n            o[v[0]] = v[1];\n          });\n\n          // Set all authMechanismProperties\n          dbOptions.authMechanismProperties = o;\n          // Set the service name value\n          if (typeof o.SERVICE_NAME === 'string') dbOptions.gssapiServiceName = o.SERVICE_NAME;\n          if (typeof o.SERVICE_REALM === 'string') dbOptions.gssapiServiceRealm = o.SERVICE_REALM;\n          if (typeof o.CANONICALIZE_HOST_NAME === 'string')\n            dbOptions.gssapiCanonicalizeHostName =\n              o.CANONICALIZE_HOST_NAME === 'true' ? true : false;\n        }\n        break;\n      case 'wtimeoutMS':\n        dbOptions.wtimeout = parseInt(value, 10);\n        break;\n      case 'readPreference':\n        if (!ReadPreference.isValid(value))\n          throw new Error(\n            'readPreference must be either primary/primaryPreferred/secondary/secondaryPreferred/nearest'\n          );\n        dbOptions.readPreference = value;\n        break;\n      case 'maxStalenessSeconds':\n        dbOptions.maxStalenessSeconds = parseInt(value, 10);\n        break;\n      case 'readPreferenceTags':\n        {\n          // Decode the value\n          value = decodeURIComponent(value);\n          // Contains the tag object\n          let tagObject = {};\n          if (value == null || value === '') {\n            dbOptions.read_preference_tags.push(tagObject);\n            break;\n          }\n\n          // Split up the tags\n          let tags = value.split(/,/);\n          for (let i = 0; i < tags.length; i++) {\n            let parts = tags[i].trim().split(/:/);\n            tagObject[parts[0]] = parts[1];\n          }\n\n          // Set the preferences tags\n          dbOptions.read_preference_tags.push(tagObject);\n        }\n        break;\n      case 'compressors':\n        {\n          compression = serverOptions.compression || {};\n          let compressors = value.split(',');\n          if (\n            !compressors.every(function(compressor) {\n              return compressor === 'snappy' || compressor === 'zlib';\n            })\n          ) {\n            throw new Error('Compressors must be at least one of snappy or zlib');\n          }\n\n          compression.compressors = compressors;\n          serverOptions.compression = compression;\n        }\n        break;\n      case 'zlibCompressionLevel':\n        {\n          compression = serverOptions.compression || {};\n          let zlibCompressionLevel = parseInt(value, 10);\n          if (zlibCompressionLevel < -1 || zlibCompressionLevel > 9) {\n            throw new Error('zlibCompressionLevel must be an integer between -1 and 9');\n          }\n\n          compression.zlibCompressionLevel = zlibCompressionLevel;\n          serverOptions.compression = compression;\n        }\n        break;\n      case 'retryWrites':\n        dbOptions.retryWrites = value === 'true';\n        break;\n      case 'minSize':\n        dbOptions.minSize = parseInt(value, 10);\n        break;\n      default:\n        {\n          let logger = Logger('URL Parser');\n          logger.warn(`${name} is not supported as a connection string option`);\n        }\n        break;\n    }\n  });\n\n  // No tags: should be null (not [])\n  if (dbOptions.read_preference_tags.length === 0) {\n    dbOptions.read_preference_tags = null;\n  }\n\n  // Validate if there are an invalid write concern combinations\n  if (\n    (dbOptions.w === -1 || dbOptions.w === 0) &&\n    (dbOptions.journal === true || dbOptions.fsync === true || dbOptions.safe === true)\n  )\n    throw new Error('w set to -1 or 0 cannot be combined with safe/w/journal/fsync');\n\n  // If no read preference set it to primary\n  if (!dbOptions.readPreference) {\n    dbOptions.readPreference = 'primary';\n  }\n\n  // make sure that user-provided options are applied with priority\n  dbOptions = Object.assign(dbOptions, options);\n\n  // Add servers to result\n  object.servers = servers;\n\n  // Returned parsed object\n  return object;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}